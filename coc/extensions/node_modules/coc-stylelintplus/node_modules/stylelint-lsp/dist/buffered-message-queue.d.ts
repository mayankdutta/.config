import { CancellationToken, GenericNotificationHandler, GenericRequestHandler, IConnection, NotificationHandler, NotificationType, RPCMessageType, RequestHandler, RequestType, VersionedTextDocumentIdentifier } from "vscode-languageserver";
export declare function isThenable<T>(value: any): value is Thenable<T>;
export interface Request<TParam, TReturn> {
    method: RPCMessageType["method"];
    param: TParam;
    documentVersion: VersionedTextDocumentIdentifier["version"];
    resolve: (value: TReturn | Thenable<TReturn>) => void;
    reject: (error?: any) => void;
    token?: CancellationToken;
}
export declare function isRequest(value: any): value is Request<any, any>;
export interface Notification<TParam> {
    method: RPCMessageType["method"];
    param: TParam;
    documentVersion: VersionedTextDocumentIdentifier["version"];
}
export declare type Message<TParam, TReturn> = Request<TParam, TReturn> | Notification<TParam>;
export declare type VersionLens<TParam> = (param: TParam) => VersionedTextDocumentIdentifier["version"];
export declare type RequestHandlerMap = Map<string, {
    handler: GenericRequestHandler<any, any>;
    versionLens: VersionLens<any>;
}>;
export declare type NotificationHandlerMap = Map<string, {
    handler: GenericNotificationHandler;
    versionLens: VersionLens<any>;
}>;
export default class BufferedMessageQueue {
    private connection;
    private queue;
    private requestHandlers;
    private notificationHandlers;
    private timer?;
    constructor(connection: IConnection);
    onRequest<TParam, TReturn, TError, TR0>(type: RequestType<TParam, TReturn, TError, TR0>, handler: RequestHandler<TParam, TReturn, TError>, versionLens: VersionLens<TParam>): void;
    onNotification<TParam, TR0>(type: NotificationType<TParam, TR0>, handler: NotificationHandler<TParam>, versionLens: VersionLens<TParam>): void;
    addNotification<TParam, TR0>(type: NotificationType<TParam, TR0>, param: TParam, documentVersion: VersionedTextDocumentIdentifier["version"]): void;
    private next;
    private popQueue;
}
